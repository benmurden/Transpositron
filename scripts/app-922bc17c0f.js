!function(){"use strict";angular.module("transpositron",["ngAnimate","ngCookies","ngTouch","ngMaterial"])}(),function(){"use strict";function e(e,t,n){this.NOTES=function(){function e(e){return 440*Math.pow(2,(e-69)/12)}for(var t={},n="CcDdEFfGgAaB",a=0;8>a;++a)for(var o=0;12>o;++o)t[n[o]+a]=e(12*a+o);return t}(),this.noteList=function(){for(var e=[],t="CcDdEFfGgAaB",n=0;8>n;++n)for(var a=0;12>a;++a)e.push(t[a]+n);return e}(),this.waveform="sine",this.waveforms={},this.envelopeDefs={a:.02,d:.6,s:.4,r:.25},this._playing={};var a=["sine","square","sawtooth","triangle"],o=new window.AudioContext,r=o.createDynamicsCompressor();this.setWaveform=function(r){var i=this;this.waveform=r,-1!==e.indexOf(a,r.toLowerCase())||this.waveforms[r]||n.getWavetable(r).then(function(e){i.waveforms[r]=o.createPeriodicWave(e.real,e.imag)},function(){t.error("Error loading instrument "+r)})},this.buildOscillatorObject=function(n){var i=o.createOscillator(),s=this.NOTES[n],u=o.createGain(),l=this.waveform;return-1!==e.indexOf(a,l.toLowerCase())?i.type=l.toLowerCase():this.waveforms[l]?(i.type="custom",i.setPeriodicWave(this.waveforms[l])):t.warning("Still loading your instrument."),i.connect(u),u.connect(r),r.connect(o.destination),i.frequency.value=s,{osc:i,gain:u}},this.playNote=function(e,t){var n=this.buildOscillatorObject(e),a=o.currentTime,r=this.envelopeDefs.a,i=this.envelopeDefs.d,s=this.envelopeDefs.s,u=this.envelopeDefs.r;this.envelope(n.gain,a,1,t,r,i,s,u),n.osc.start(a),n.osc.stop(a+r+i+t+u)},this.envelope=function(e,t,n,a,o,r,i,s){var u=e.gain;u.cancelScheduledValues(0),u.setValueAtTime(0,t),u.linearRampToValueAtTime(n,t+o),u.linearRampToValueAtTime(n*i,t+o+r),u.setValueAtTime(n*i,t+o+r+a),u.linearRampToValueAtTime(0,t+o+r+a+s)},this.startEnvelope=function(e,t,n,a,o,r){var i=e.gain;i.cancelScheduledValues(0),i.setValueAtTime(0,t),i.linearRampToValueAtTime(n,t+a),i.linearRampToValueAtTime(n*r,t+a+o)},this.endEnvelope=function(e,t,n){var a=e.gain;a.cancelScheduledValues(0),a.setValueAtTime(e.gain.value,t),a.linearRampToValueAtTime(0,t+n)},this.startNote=function(e){var t=this.buildOscillatorObject(e),n=o.currentTime,a=this.envelopeDefs.a,r=this.envelopeDefs.d,i=this.envelopeDefs.s;this.startEnvelope(t.gain,n,1,a,r,i),t.osc.start(n),this._playing[e]=t},this.endNote=function(t){var n=e.get(this._playing,t,!1),a=o.currentTime,r=this.envelopeDefs.r;n&&(this.endEnvelope(n.gain,a,r),n.osc.stop(a+r),delete this._playing[t])},this.clean=function(){}}angular.module("transpositron").service("webAudioPlayer",e),e.$inject=["_","toastr","wavetables"]}(),function(){"use strict";function e(e,t,n){this.getWavetable=function(o){return n(function(n,r){a[o]?n(a[o]):e.get("/assets/wavetables/"+o+".json").then(function(e){var t=new Float32Array(e.data.real),r=new Float32Array(e.data.imag);a[o]={real:t,imag:r},n(a[o])},function(e){t.warn("Problem loading wavetable",e),r(e)})})};var a={}}angular.module("transpositron").service("wavetables",e),e.$inject=["$http","$log","$q"]}(),function(){"use strict";function e(e){function t(t,n,a,o){var r,i=e(n[0],{typeSpeed:40,deleteSpeed:40,pauseDelay:800,loop:!0,postfix:" "});n.addClass("acme-malarkey"),angular.forEach(t.extraValues,function(e){i.type(e).pause()["delete"]()}),r=t.$watch("vm.contributors",function(){angular.forEach(o.contributors,function(e){i.type(e.login).pause()["delete"]()})}),t.$on("$destroy",function(){r()})}function n(e,t){function n(){return a().then(function(){e.info("Activated Contributors View")})}function a(){return t.getContributors(10).then(function(e){return o.contributors=e,o.contributors})}var o=this;o.contributors=[],n()}var a={restrict:"E",scope:{extraValues:"="},template:"&nbsp;",link:t,controller:n,controllerAs:"vm"};return n.$inject=["$log","githubContributor"],a}angular.module("transpositron").directive("acmeMalarkey",e),e.$inject=["malarkey"]}(),function(){"use strict";function e(){function e(e){var t=this;t.relativeDate=e(t.creationDate).fromNow()}var t={restrict:"E",templateUrl:"app/components/navbar/navbar.html",scope:!0,controller:e,controllerAs:"vm",bindToController:{creationDate:"="}};return e.$inject=["moment"],t}angular.module("transpositron").directive("acmeNavbar",e)}(),function(){"use strict";function e(e){this.listener=new e.Listener,this.convert_key_to_readable=function(t){return e._keycode_dictionary[t]}}angular.module("transpositron").service("keypressHelper",e),e.$inject=["keypress"]}(),function(){"use strict";function e(e,t){function n(n){function o(e){return e.data}function r(t){e.error("XHR Failed for getContributors.\n"+angular.toJson(t.data,!0))}return n||(n=30),t.get(a+"/contributors?per_page="+n).then(o)["catch"](r)}var a="https://api.github.com/repos/Swiip/generator-gulp-angular",o={apiHost:a,getContributors:n};return o}angular.module("transpositron").factory("githubContributor",e),e.$inject=["$log","$http"]}(),function(){"use strict";function e(e,t,n,a,o,r,i){function s(){l.mapKeysToNotes(),e(function(){l.classAnimation="rubberBand"},4e3);var t=[];l.keySequence.forEach(function(e){t.push({keys:e,on_keydown:function(e,t,n){n||l.keyDown(e)},on_keyup:function(e){l.keyUp(e)}})}),a.listener.register_many(t)}function u(){r.info('Fork <a href="https://github.com/Swiip/generator-gulp-angular" target="_blank"><b>generator-gulp-angular</b></a>'),l.classAnimation=""}var l=this;l.awesomeThings=[],l.classAnimation="",l.creationDate=1440125657487,l.showToastr=u,l.ap=n,l.keySequence=["z","x","c","v","b","n","m",",",".","a","s","d","f","g","h","j","k","l",";","'","q","w","e","r","t","y","u","i","o","p","[","]"],l.scale="2212221",l.baseOctave=2,l.baseKeyOffset=0,l.keyNoteMap={},l.notesPlaying=[],l.mapKeysToNotes=function(){var e=0;l.keySequence.forEach(function(t,a){l.keyNoteMap[t]=n.noteList[12*l.baseOctave+e+parseInt(l.baseKeyOffset)],e+=parseInt(l.scale[a%l.scale.length])})},l.keyDown=function(e){var o=a.convert_key_to_readable(e.keyCode),r=i.indexOf(l.keySequence,o);-1!==r&&l.keyNoteMap[o]&&(t.log(e.keyCode,l.keyNoteMap[o]),l.notesPlaying.push(l.keyNoteMap[o]),n.startNote(l.keyNoteMap[o]))},l.keyUp=function(e){var o=a.convert_key_to_readable(e.keyCode),r=i.indexOf(l.keySequence,o);-1!==r&&l.keyNoteMap[o]&&(t.log("Key up: "+e.keyCode,l.keyNoteMap[o]),i.remove(l.notesPlaying,l.keyNoteMap[o]),n.endNote(l.keyNoteMap[o]))},l.setWaveform=function(){n.setWaveform(l.waveform)},s(),l.scales=[{name:"Aeolian",value:"2122122"},{name:"Algerian",value:"21211131"},{name:"Arabian A",value:"21212121"},{name:"Arabian B",value:"2211222"},{name:"Asavari Theta",value:"2122122"},{name:"Balinese",value:"12414"},{name:"Bhairav",value:"1312131"},{name:"Byzantine",value:"1312131"},{name:"Egyptian",value:"23232"},{name:"Major",value:"2212221"},{name:"Lydian",value:"2221221"},{name:"Locrian",value:"1221222"},{name:"Chinese",value:"42141"},{name:"Japanese A",value:"14214"},{name:"Japanese B",value:"23214"},{name:"Japanese (Ichikosucho)",value:"22111221"},{name:"Japanese (Taishikicho)",value:"221112111"}],l.naturalKeys=[{name:"C",value:0},{name:"C#",value:1},{name:"D",value:2},{name:"D#",value:3},{name:"E",value:4},{name:"F",value:5},{name:"F#",value:6},{name:"G",value:7},{name:"G#",value:8},{name:"A",value:9},{name:"A#",value:10},{name:"B",value:11}],l.waveforms=["Sine","Square","Triangle","Sawtooth","01_Saw","02_Triangle","03_Square","04_Noise","05_Pulse","06_Warm_Saw","07_Warm_Triangle","08_Warm_Square","09_Dropped_Saw","10_Dropped_Square","11_TB303_Square","Bass","Bass_Amp360","Bass_Fuzz","Bass_Fuzz_ 2","Bass_Sub_Dub","Bass_Sub_Dub_2","Brass","Brit_Blues","Brit_Blues_Driven","Buzzy_1","Buzzy_2","Celeste","Chorus_Strings","Dissonant Piano","Dissonant_1","Dissonant_2","Dyna_EP_Bright","Dyna_EP_Med","Ethnic_33","Full_1","Full_2","Guitar_Fuzz","Harsh","Mkl_Hard","Organ_2","Organ_3","Phoneme_ah","Phoneme_bah","Phoneme_ee","Phoneme_o","Phoneme_ooh","Phoneme_pop_ahhhs","Piano","Putney_Wavering","Throaty","Trombone","Twelve String Guitar 1","Twelve_OpTines","Wurlitzer","Wurlitzer_2"]}angular.module("transpositron").controller("MainController",e),e.$inject=["$timeout","$log","webAudioPlayer","keypressHelper","wavetables","toastr","_"]}(),function(){"use strict";function e(e){e.debug("runBlock end")}angular.module("transpositron").run(e),e.$inject=["$log"]}(),function(){"use strict";angular.module("transpositron").constant("malarkey",malarkey).constant("toastr",toastr).constant("moment",moment).constant("keypress",keypress).constant("_",_)}(),function(){"use strict";function e(e,t){e.debugEnabled(!0),t.options.timeOut=3e3,t.options.positionClass="toast-top-right",t.options.preventDuplicates=!0,t.options.progressBar=!0,window.AudioContext=window.AudioContext||window.webkitAudioContext}angular.module("transpositron").config(e),e.$inject=["$logProvider","toastr"]}(),angular.module("transpositron").run(["$templateCache",function(e){e.put("app/components/navbar/navbar.html",'<md-toolbar layout="row" layout-align="center center"><md-button href="/">Transpositron</md-button><section flex="" layout="row" layout-align="left center"><md-button href="/#/" class="md-raised">Home</md-button><md-button href="/#/about/" class="md-raised">About</md-button></section><md-button class="acme-navbar-text">Application was created {{ vm.relativeDate }}.</md-button></md-toolbar>')}]);